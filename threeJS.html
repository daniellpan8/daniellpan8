<!DOCTYPE html>
<html>
<head>
  	<meta charset="utf-8">
  	<title>Three.js Example</title>
  	<style>
    	body { margin: 0; }
    	canvas { width: 100%; height: 100%; }
    	
  

@media only screen and (min-width: 600px) {
  canvas {
    height: 100%;
  }
}
  	</style>
</head>
<body>

  	<script type="module">

	    import * as THREE from 'https://cdn.jsdelivr.net/npm/three@0.121.1/build/three.module.js';
	    import { OrbitControls } from 'https://cdn.jsdelivr.net/npm/three@0.121.1/examples/jsm/controls/OrbitControls.js';
	    import { RGBELoader } from 'https://cdn.jsdelivr.net/npm/three@0.121.1/examples/jsm/loaders/RGBELoader.js';
	    import { GLTFLoader } from 'https://cdn.jsdelivr.net/npm/three@0.121.1/examples/jsm/loaders/GLTFLoader.js';

	    const renderer = new THREE.WebGLRenderer();
	    renderer.setSize(window.innerWidth, window.innerHeight);
	    
	    

	    const scene = new THREE.Scene();

	    //scene. fog = new THREE. Fog( 0xffffff, 0.015, 100 );

	    const camera = new THREE.PerspectiveCamera(45, window.innerWidth / window.innerHeight, 1, 10000);
	    
	    camera.position.set(3, 10, 3);
	    

	    //renderer.domElement.addEventListener('mousemove', onMouseMove);
//renderer.domElement.addEventListener('mouseleave', onMouseLeave);
/*
	    const textureLoader = new THREE.TextureLoader();
		const texture = textureLoader.load('https://cdn.polyhaven.com/asset_img/primary/christmas_photo_studio_06.png?height=780', function(texture) {
			texture.mapping = THREE.EquirectangularReflectionMapping;
			texture.encoding = THREE.sRGBEncoding;
		});

		scene.background = texture;
		scene.environment = texture;

*/

		const textureLoader = new THREE.TextureLoader();
		//const texture = textureLoader.load('https://dl.polyhaven.org/file/ph-assets/HDRIs/extra/Tonemapped%20JPG/workshop.jpg');
		const texture = textureLoader.load('https://cdn.polyhaven.com/asset_img/primary/christmas_photo_studio_06.png?height=780');

		

		texture.mapping = THREE.EquirectangularReflectionMapping;
		texture.encoding = THREE.sRGBEncoding;
		texture.anisotropy = renderer.capabilities.getMaxAnisotropy();
		texture.wrapS = THREE.RepeatWrapping;
		texture.repeat.set(2, 1);
		scene.background = texture;
		scene.environment = texture;
	    

	    renderer.toneMapping = THREE.ACESFilmicToneMapping;
	    renderer.toneMappingExposure = 1.0;


	    renderer.shadowMap.enabled = true;
	    renderer.shadowMap.type = THREE.BasicShadowMap;

	    document.body.appendChild(renderer.domElement);

	    //orbit controls
	    const controls = new OrbitControls(camera, renderer.domElement);
	    controls.target.set(0, 10, 0);
	    controls.autoRotate = true;
	    controls.autoRotateSpeed = 0.5;
	    controls.enableDamping = true;
	    //controls.maxDistance = 11;

	    //controls.enablePan = false;


	    //room loader
	    const loader = new GLTFLoader();
		loader.load('myRoom.glb', function(gltf) {
    		const object = gltf.scene;
    		object.scale.set(5,5,5);
    		object.traverse((node) => {
        		if (node.isMesh) {
            		node.castShadow = true;
            		node.receiveShadow = true;
            		node.material.envMap = texture; // set envMap to the texture
      				node.material.envMapIntensity = 1;
        		}
    		});
    		scene.add(object);
		}, undefined, function(error) {
    		console.error(error);
		});

		loader.load('faceScan2.glb', function(g) {
			const face = g.scene;
    		face.scale.set(15,15,15);
    		face.position.set(0, 8, -9);
    		face.rotation.y = Math.PI;
    		face.traverse((node) => {
        		if (node.isMesh) {
            		node.castShadow = true;
            		node.receiveShadow = true;
        		}
    		});
    		scene.add(face);
		}, undefined, function(error) {
    		console.error(error);
		});


	   

	    //directionalLight
	    /*
	    const light = new THREE.PointLight(0xffffff, 0.5, 100);
	    light.position.set(15, 0, 15);
	    scene.add(light);

	    const light2 = new THREE.PointLight(0xffffff, 0.5, 100);
	    light2.position.set(-15, 0, -15);
	    scene.add(light2);
	    */

	    const light4 = new THREE.PointLight(0xffffff, 1, 100);
	    light4.position.set(0, 20, 0);
	    light4.castShadow = true;
	    light4.shadow.mapSize.width = 2048;
		light4.shadow.mapSize.height = 2048;
		light4.shadow.bias = -0.0005;
	    scene.add(light4);

	    var lightGeometry = new THREE.SphereGeometry(0.3, 50, 50, 0, Math.PI * 2, 0, Math.PI * 2);
		const lightMaterial = new THREE.MeshStandardMaterial( { color: 0xffffff} );
		var lightSphere = new THREE.Mesh(lightGeometry, lightMaterial);
		lightSphere.position.set(0, 30, 0);
	    scene.add(lightSphere);

	    var sphereGeometry = new THREE.SphereGeometry(0.5, 50, 50, 0, Math.PI * 2, 0, Math.PI * 2);
	    var sphere = new THREE.Mesh(sphereGeometry, lightMaterial);
	    sphere.position.set(0,10,0);
	    sphere.castShadow = true;
	    sphere.addEventListener('click', function() {
	    	console.log('Sphere clicked!');
  			window.location.href = 'index.html';
		});
	    scene.add(sphere);

	    

	    //plane?
	    const cubeGeometry = new THREE.BoxGeometry(100, 1, 100);
		const cubeMaterial = new THREE.MeshStandardMaterial({color: 0x00ff00});

// Create cube mesh and set its position
		const cube = new THREE.Mesh(cubeGeometry, cubeMaterial);
		cube.position.set(0, -5, 0);
		cube.receiveShadow = true;

// Add cube to the scene
		scene.add(cube);

	    //ambientLight
	    const light3 = new THREE.AmbientLight(0x404040);
		scene.add(light3);

		//directional light source
		
		
		//gridHelper
	    const gridHelper = new THREE.GridHelper(200, 50, 0xfc03d7, 0xffff00);
		gridHelper.material.opacity = 0.5;
		gridHelper.material.transparent = true;
		scene.add(gridHelper);
		//gridHelper.rotation.x = Math.PI/2;
		//gridHelper.rotation.y = Math.PI/1;
		
	

	    

	    //animatiion
	    function animate() {
	    	requestAnimationFrame(animate);

	   
		    controls.update();

		    renderer.render(scene, camera);

		}
		function render() {
  			requestAnimationFrame(render);
  			renderer.render(scene, camera);
		}

		
	    animate();
	    render();

	    //window.addEventListener('mousemove', onMouseMove);

  	</script>


</body>
</html>
